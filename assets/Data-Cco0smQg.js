import{C as b,c as v,r as j,d as D,bH as S,j as e,o as F,t as I,k as w}from"./index-DFgtkTYC.js";import{b7 as K}from"./Layout-CIm6QYZN.js";import{F as s}from"./index-D1L2R7lU.js";import{C as i}from"./index-DZp66-aT.js";import{T as a,R as T,C as c}from"./index-B38hVekn.js";import{B as p,M as B}from"./index-DUx-6r-C.js";import{P as g}from"./progress-C2QfQfXA.js";import{S as t}from"./index-pl73aUh0.js";import"./index-VY5kNFhJ.js";import"./index-DL9K0yEa.js";import"./index-DUmcZH79.js";import"./useVariants-Lmi2ebBK.js";import"./EllipsisOutlined-B53JwfDV.js";import"./Overflow-CMIZo8PN.js";import"./index-D0rPzH-E.js";import"./CheckOutlined-DAM7Vbmf.js";import"./index-oGcLkKQX.js";import"./SearchOutlined-Dp3Prlso.js";const f="/v1/data",R=async()=>await b.get(`${f}`),L=async n=>await b.post(`${f}`,n),P=async n=>await b.post(`${f}/dow-file`,n),E=async n=>await b.post(`${f}`,n),M={backup:R,restore:L,dowBackupFile:P,dowBackupData:E},te=()=>{const n=v(),[d,r]=j.useState(!1),[x,o]=j.useState(null),[y]=s.useForm(),N=h=>{const m=Object.fromEntries(Object.entries(h).filter(([O,C])=>C!==void 0));Object.keys(m).length>0?(F("restore","Đang Khôi Phục Dữ Liệu..."),M.restore({collections:m}).then(()=>{I("restore","Khôi Phục Dữ Liệu Thành Công!","Dữ liệu đã được khôi phục lại!"),y.resetFields(),r(!1)}).catch(()=>{w("restore","Khôi Phục Dữ Liệu Thất Bại!","Vui lòng thử lại sau!")})):w("restore","Khôi Phục Dữ Liệu Thất Bại!","Vui lòng chọn ít nhất 1 bản ghi cần khôi phục!")},{restore:u,loading:k}=D(h=>h.restore),l=j.useMemo(()=>{var h;return(h=u==null?void 0:u.newData)==null?void 0:h.children.map(m=>({label:m.name,value:m.name}))},[u]);return j.useEffect(()=>{k&&n(S({folderName:"uploads/backup"}))},[]),e.jsxs(K,{title:"Dữ liệu",header:"DỮ LIỆU",children:[e.jsx(i,{className:"h-full",title:e.jsxs(e.Fragment,{children:["Khôi phục dữ liệu ",e.jsx(a.Link,{className:"text-base",children:"data"})]}),children:e.jsxs(T,{gutter:[24,24],children:[e.jsx(c,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu Website"}),e.jsx(p,{type:"primary",onClick:()=>{r(!0),o("website")},children:" Khôi phục"})]})})}),e.jsx(c,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu người dùng"}),e.jsx(p,{type:"primary",onClick:()=>{r(!0),o("users")},children:" Khôi phục"})]})})}),e.jsx(c,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu khóa học"}),e.jsx(p,{type:"primary",onClick:()=>{r(!0),o("courses")},children:" Khôi phục"})]})})}),e.jsx(c,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu đơn hàng"}),e.jsx(p,{type:"primary",onClick:()=>{r(!0),o("orders")},children:" Khôi phục"})]})})}),e.jsx(c,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(i,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:"Khôi phục khác"}),e.jsx(p,{type:"primary",onClick:()=>{r(!0),o("others")},children:" Khôi phục"})]})})}),e.jsx(c,{span:"24",children:e.jsx(i,{className:"h-full",title:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:" Dữ liệu (Data)"}),e.jsx(a.Title,{level:5,className:"!my-0",children:" 45 GB"})]}),children:e.jsx(g,{className:"mb-2",percent:90,status:"active",percentPosition:{align:"center",type:"inner"},size:["100%",22],strokeColor:{from:"#F6E96B",to:"#ffc000"}})})}),e.jsx(c,{span:"24",children:e.jsx(i,{className:"h-full",title:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:" Dữ liệu (File Media Image,Video,3D,...)"}),e.jsx(a.Title,{level:5,className:"!my-0",children:" 45 GB"})]}),children:e.jsx(g,{className:"mb-2",percent:90,status:"active",percentPosition:{align:"center",type:"inner"},size:["100%",22],strokeColor:{from:"#F6E96B",to:"#ffc000"}})})})]})}),e.jsx(B,{title:"Chọn bản ghi cần khôi phục",centered:!0,open:d,onOk:()=>y.submit(),onCancel:()=>r(!1),children:e.jsx(s,{form:y,name:"customRes",layout:"vertical",onFinish:N,children:x=="website"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Thông tin website",className:"mb-2",name:"infos",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách bài viết",className:"mb-2",name:"pages",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách nhóm bài viết",className:"mb-2",name:"grouppages",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Layout Masonries",className:"mb-2",name:"masonries",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Bố cục (Header - Footer)",className:"mb-2",name:"layouts",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):x=="courses"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách khóa học",className:"mb-2",name:"courses",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh mục khóa học",className:"mb-2",name:"categorycourses",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):x=="users"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách người dùng",className:"mb-2",name:"users",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Phân quyền",className:"mb-2",name:"roles",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):x=="orders"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Key thanh toán",className:"mb-2",name:"keybanks",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách đơn hàng",className:"mb-2",name:"orders",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách plugins",className:"mb-2",name:"plugins",children:e.jsx(t,{showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Cài đặt",className:"mb-2",name:"settings",children:e.jsx(t,{disabled:!0,showSearch:!0,options:l,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]})})})]})};export{te as default};
