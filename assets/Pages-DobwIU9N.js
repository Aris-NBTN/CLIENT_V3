import{c as V,d as k,r as s,j as e,b9 as j,ba as q,bb as $,as as h,N as X,V as n,bc as Q,k as R,bd as H,be as J,bf as K,bg as U,bh as W,bi as Y,bj as Z}from"./index-D1twGZ3Z.js";import{ba as ee,b7 as te}from"./Layout-DnOueL-M.js";import{E as T}from"./Table-CV13tQ_a.js";import{F as d,a as ae}from"./Filter-Bbg4mPE5.js";import{f as re,e as ne}from"./Format-B63FgtZj.js";import{T as u,v as ie,w as se,x as C}from"./index-BddFcSMz.js";import{e as le}from"./export-Bc9RwKXc.js";import{F as l}from"./index-CdlybJdo.js";import{B as o,M as S}from"./index-3t2dR2Qx.js";import{I as w}from"./index-ABG0vLxO.js";import{T as oe}from"./index-OgyVthAO.js";import"./index-ydiNlzYj.js";import"./index-CJ-jR0EN.js";import"./index-B2WZndIg.js";import"./index-Djmlvon0.js";import"./Overflow-BVKK6jMn.js";import"./useVariants-FsczrwmZ.js";import"./index-CY4fJX-W.js";import"./CheckOutlined-D4YI-g4j.js";import"./SearchOutlined-DnKBSmV6.js";import"./Table-D66CHkwD.js";import"./iconUtil-BxKQ3HoK.js";import"./EllipsisOutlined-oEcpAQlt.js";import"./index-DkJs-5uS.js";import"./index-D41y7oX1.js";import"./index-ClEi16nY.js";import"./index-CXyldGPh.js";import"./index-DesCQbv_.js";import"./html2canvas.esm-CBrSDip1.js";const _e=()=>{const r=V(),N=ee({query:"(max-width: 576px)"}),[g]=l.useForm(),[m]=l.useForm(),{pages:i,loading:x}=k(t=>t.pages),{groupPages:f,loading:c}=k(t=>t.groupPages),a=f==null?void 0:f.newData,[P,b]=s.useState(!1),[D,y]=s.useState(!1),[A,F]=s.useState(localStorage.getItem("drag")==="true"),I=s.useMemo(()=>{var t;return(t=i==null?void 0:i.newData)==null?void 0:t.map(p=>({...p,key:p._id}))},[i]),E=s.useMemo(()=>a==null?void 0:a.map(t=>({...t,key:t._id})),[a]),v=[{title:"Tên trang",dataIndex:"name",width:"15%",editable:!0,...d({dataIndex:"name",handleTableChange:({searchText:t,searchedColumn:p})=>{t?n(r,Z({[p]:t})):r(j({page:1,limit:localStorage.getItem("pageSize")||10}))}})},{title:"Link Trang",dataIndex:"slug",width:"15%",editable:!1,...d({dataIndex:"slug"}),render:t=>e.jsx(e.Fragment,{children:e.jsx(u.Paragraph,{className:"!mb-0",ellipsis:{suffix:""},copyable:{text:`/${t}`},children:t})})},{title:"Tiêu đề trang",dataIndex:"title",width:"15%",editable:!0,...d({dataIndex:"title"})},{title:"Mô tả",dataIndex:"description",width:"15%",editable:!0,...d({dataIndex:"description"})},{title:"Từ khóa",dataIndex:"keywords",width:"15%",type:"tag",editable:!0,render:t=>e.jsx(re,{keywords:t})},{title:"Nhóm",dataIndex:"group",width:"8%",type:"select",editable:!0,optionSelect:Array.isArray(a)&&(a==null?void 0:a.length)>0?a==null?void 0:a.map(t=>({label:t.group,value:t._id})):[],render:t=>t&&a&&Array.isArray(a)&&(a==null?void 0:a.length)>0?ne(t,a,"group"):null,...Array.isArray(a)&&(a==null?void 0:a.length)>0?ae("group",a==null?void 0:a.map(t=>({text:t.group,value:t._id}))):{}}],G=[{title:"Tên nhóm",dataIndex:"group",width:"60%",type:"text",editable:!0,...d({dataIndex:"group"})}],M=t=>{n(r,H(t),()=>{b(!1),g.resetFields()})},B=t=>{n(r,J(t))},z=t=>{n(r,K(t))},L=t=>{n(r,U(t),()=>{y(!1),m.resetFields()})},_=t=>{n(r,W(t))},O=t=>{n(r,Y(t))};return s.useEffect(()=>{x&&r(j({page:1,limit:localStorage.getItem("pageSize")||10}))},[]),s.useEffect(()=>{c===!0&&r(q())},[]),e.jsxs(te,{title:"Bài viết",header:"BÀI VIẾT",button:e.jsxs(e.Fragment,{children:[A?e.jsx(o,{onClick:()=>{F(!1),localStorage.setItem("drag","false")},children:e.jsx(u,{children:"Tắt sắp xếp"})}):e.jsx(o,{type:"primary",onClick:()=>{F(!0),localStorage.setItem("drag","true")},children:"Bật sắp xếp"}),e.jsx(o,{type:"primary",onClick:()=>y(!0),children:"Thêm nhóm"}),e.jsx(o,{type:"primary",onClick:()=>b(!0),children:"Thêm trang"}),e.jsx(o,{onClick:()=>le(I,"Pages.xlsx"),type:"primary",children:"Xuất file Excel"})]}),children:[e.jsx(T,{dragMode:A,Api:j,ApiPut:$,total:i==null?void 0:i.totalItems,loading:x,data:I,columns:v,onSave:B,onDelete:z,width:"12%",button:t=>e.jsxs(e.Fragment,{children:[e.jsx(h,{title:"Xem trang",children:e.jsx(X,{to:t.slug==="trang-chu"?"/":`/${t.slug}`,target:"_blank",children:e.jsx(ie,{size:22,color:"#006aff"})})}),e.jsx(h,{title:"Sao chép trang",children:e.jsx(u,{onClick:()=>n(r,Q(t._id)),children:e.jsx(se,{size:22,color:"#55ff00"})})}),N?e.jsx(e.Fragment,{children:e.jsx(h,{title:"Chỉnh sửa trang",children:e.jsx(u.Link,{onClick:()=>R("","Bạn không thể truy cập trang này!","Vui lòng sử dụng máy tính để trãi nghiệm tốt nhất!"),children:e.jsx(C,{size:22,color:"rgb(255 127 0)"})})})}):e.jsx(h,{title:"Chỉnh sửa trang",children:e.jsx("a",{href:`/admin/page/${t.slug}`,children:e.jsx(C,{size:22,color:"rgb(255 127 0)"})})})]})}),e.jsx(S,{title:"Thêm trang",centered:!0,open:P,onOk:()=>g.submit(),onCancel:()=>b(!1),confirmLoading:x,width:500,children:e.jsx(l,{form:g,name:"customForm",layout:"vertical",onFinish:M,children:e.jsx(l.Item,{label:"Tên trang",className:"mb-2",name:"name",rules:[{required:!0,message:"Vui lòng nhập tên trang!"}],children:e.jsx(w,{className:"mb-2",placeholder:"Nhập tên trang"})})})}),e.jsx(S,{centered:!0,open:D,confirmLoading:c,onOk:()=>m.submit(),onCancel:()=>y(!1),footer:null,width:600,children:e.jsx(oe,{centered:!0,items:[{label:"Thêm nhóm",key:"1",children:e.jsx(e.Fragment,{children:e.jsxs(l,{form:m,name:"customForm",layout:"vertical",onFinish:L,children:[e.jsx(l.Item,{className:"mb-3",name:"group",label:"Tên nhóm",rules:[{required:!0,message:"Nhập tên nhóm!"}],children:e.jsx(w,{placeholder:"Nhập nhóm"})}),e.jsx(o,{type:"primary",loading:c,onClick:()=>m.submit(),className:"flex float-end",children:"Thêm nhóm"})]})})},{label:"Chỉnh sửa nhóm",key:"2",children:e.jsx(e.Fragment,{children:e.jsx(T,{loading:c,data:E,isScroll:!1,columns:G,width:"10%",onSave:_,onDelete:O})})}]})})]})};export{_e as default};
