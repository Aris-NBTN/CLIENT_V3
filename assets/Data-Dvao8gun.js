import{V as b,q as v,r as j,s as D,bI as I,j as e,E as S,t as F,I as w}from"./index-Co2b9eaw.js";import{b7 as K}from"./Layout-CO6MfcDm.js";import{F as s}from"./index-D9ZCA4cv.js";import{C as r}from"./index-MbpadzHj.js";import{T as a}from"./index-C9Iasnmy.js";import{R as T,C as c}from"./row-C7nGl_mG.js";import{B as p}from"./button-DXTTJm45.js";import{P as g}from"./progress-CnF6b38g.js";import{M as B}from"./index-BmC9q8Kg.js";import{S as l}from"./index-65az3BYH.js";import"./index-Ci2fHU3S.js";import"./EllipsisOutlined-YG-P0kjm.js";import"./Overflow-Dnojmods.js";import"./context-D7tvPcxb.js";import"./index-BSRKmVHO.js";import"./index-CjvWSmR4.js";import"./index-DvEW9LSH.js";import"./useLocale-jdbWt-Il.js";import"./PurePanel-DJf5xHWr.js";import"./Dropdown-Cgvkrd3p.js";import"./compact-item-CRF5yFSE.js";import"./index-BCRO_fax.js";import"./TextArea-DE5OntEq.js";import"./useVariants-Df-QCdQc.js";import"./CheckOutlined-WKsMoX_Y.js";import"./index-BK6sfD41.js";import"./index-CWR6teOZ.js";import"./SearchOutlined-3qvqldhn.js";const f="/v1/data",R=async()=>await b.get(`${f}`),L=async n=>await b.post(`${f}`,n),P=async n=>await b.post(`${f}/dow-file`,n),E=async n=>await b.post(`${f}`,n),M={backup:R,restore:L,dowBackupFile:P,dowBackupData:E},de=()=>{const n=v(),[d,i]=j.useState(!1),[x,o]=j.useState(null),[y]=s.useForm(),N=h=>{const m=Object.fromEntries(Object.entries(h).filter(([O,C])=>C!==void 0));Object.keys(m).length>0?(S("restore","Đang Khôi Phục Dữ Liệu..."),M.restore({collections:m}).then(()=>{F("restore","Khôi Phục Dữ Liệu Thành Công!","Dữ liệu đã được khôi phục lại!"),y.resetFields(),i(!1)}).catch(()=>{w("restore","Khôi Phục Dữ Liệu Thất Bại!","Vui lòng thử lại sau!")})):w("restore","Khôi Phục Dữ Liệu Thất Bại!","Vui lòng chọn ít nhất 1 bản ghi cần khôi phục!")},{restore:u,loading:k}=D(h=>h.restore),t=j.useMemo(()=>{var h;return(h=u==null?void 0:u.newData)==null?void 0:h.children.map(m=>({label:m.name,value:m.name}))},[u]);return j.useEffect(()=>{k&&n(I({folderName:"uploads/backup"}))},[]),e.jsxs(K,{title:"Dữ liệu",header:"DỮ LIỆU",children:[e.jsx(r,{className:"h-full",title:e.jsxs(e.Fragment,{children:["Khôi phục dữ liệu ",e.jsx(a.Link,{className:"text-base",children:"data"})]}),children:e.jsxs(T,{gutter:[24,24],children:[e.jsx(c,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(r,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu Website"}),e.jsx(p,{type:"primary",onClick:()=>{i(!0),o("website")},children:" Khôi phục"})]})})}),e.jsx(c,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(r,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu người dùng"}),e.jsx(p,{type:"primary",onClick:()=>{i(!0),o("users")},children:" Khôi phục"})]})})}),e.jsx(c,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(r,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu khóa học"}),e.jsx(p,{type:"primary",onClick:()=>{i(!0),o("courses")},children:" Khôi phục"})]})})}),e.jsx(c,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(r,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:"Khôi phục dữ liệu đơn hàng"}),e.jsx(p,{type:"primary",onClick:()=>{i(!0),o("orders")},children:" Khôi phục"})]})})}),e.jsx(c,{xl:{span:8},lg:{span:12},span:"24",children:e.jsx(r,{className:"h-full",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:"Khôi phục khác"}),e.jsx(p,{type:"primary",onClick:()=>{i(!0),o("others")},children:" Khôi phục"})]})})}),e.jsx(c,{span:"24",children:e.jsx(r,{className:"h-full",title:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:" Dữ liệu (Data)"}),e.jsx(a.Title,{level:5,className:"!my-0",children:" 45 GB"})]}),children:e.jsx(g,{className:"mb-2",percent:90,status:"active",percentPosition:{align:"center",type:"inner"},size:["100%",22],strokeColor:{from:"#F6E96B",to:"#ffc000"}})})}),e.jsx(c,{span:"24",children:e.jsx(r,{className:"h-full",title:e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx(a.Title,{level:5,className:"!my-0",children:" Dữ liệu (File Media Image,Video,3D,...)"}),e.jsx(a.Title,{level:5,className:"!my-0",children:" 45 GB"})]}),children:e.jsx(g,{className:"mb-2",percent:90,status:"active",percentPosition:{align:"center",type:"inner"},size:["100%",22],strokeColor:{from:"#F6E96B",to:"#ffc000"}})})})]})}),e.jsx(B,{title:"Chọn bản ghi cần khôi phục",centered:!0,open:d,onOk:()=>y.submit(),onCancel:()=>i(!1),children:e.jsx(s,{form:y,name:"customRes",layout:"vertical",onFinish:N,children:x=="website"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Thông tin website",className:"mb-2",name:"infos",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách bài viết",className:"mb-2",name:"pages",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách nhóm bài viết",className:"mb-2",name:"grouppages",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Layout Masonries",className:"mb-2",name:"masonries",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Bố cục (Header - Footer)",className:"mb-2",name:"layouts",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):x=="courses"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách khóa học",className:"mb-2",name:"courses",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh mục khóa học",className:"mb-2",name:"categorycourses",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):x=="users"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách người dùng",className:"mb-2",name:"users",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Phân quyền",className:"mb-2",name:"roles",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):x=="orders"?e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Key thanh toán",className:"mb-2",name:"keybanks",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Danh sách đơn hàng",className:"mb-2",name:"orders",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]}):e.jsxs(e.Fragment,{children:[e.jsx(s.Item,{label:"Danh sách plugins",className:"mb-2",name:"plugins",children:e.jsx(l,{showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})}),e.jsx(s.Item,{label:"Cài đặt",className:"mb-2",name:"settings",children:e.jsx(l,{disabled:!0,showSearch:!0,options:t,placeholder:"Chọn bản khôi phục",style:{width:"100%"}})})]})})})]})};export{de as default};
