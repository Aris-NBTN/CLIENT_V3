import{a as ve,c as ke,e as Ne,r as i,d as h,ch as we,v as _e,ci as Me,cj as A,j as e,ck as H,g as Se}from"./index-D4WFe0GN.js";import{R as Ee,C as oe,A as R,T as Le,J as be,K as Ce,L as Ie,M as Te,N as De,O as Ae,P as He,y as Re}from"./index-B45XX2tT.js";import{M as Fe}from"./index-tnIYc3TH.js";const Pe=({title:ie,description:ce,keywords:le,author:ae,ldJson:_={},children:ue})=>{var O,z,B,q,P,J,U,$,K,G,Q,V,W,X,Y,Z,ee,te;const M=ve(),x=ke(),{token:{colorPrimary:v}}=Ne.useToken(),[de,S]=i.useState(!1),E=i.useRef(null),L=i.useRef(null),b=i.useRef(null),[fe,C]=i.useState(!1),[m,he]=i.useState(),[k,me]=i.useState(()=>JSON.parse(localStorage.getItem("notify"))||[]),n=h(t=>t.menu),F=h(t=>t.menu.status),{user:l}=h(t=>t.auth),{info:o,loading:ge}=h(t=>t.info),{notificationPublic:a,loading:xe}=h(t=>t.notificationPublic),{cart:g}=h(t=>t.cart),{cartDetail:N,loading:pe}=h(t=>t.cartDetail),ye=t=>{try{if(!t)return[];const c=new DOMParser().parseFromString(t,"text/html"),s=[];return c.querySelectorAll(".nav__menu > ul > li").forEach(d=>{var ne;if(!d)return;const p=d.querySelector(".nav__link > a");if(!p)return;const y={key:p.getAttribute("href")||"#",label:((ne=p.textContent)==null?void 0:ne.trim())||""},w=d.querySelectorAll(".dropdown__menu.dropdown-aris > li"),f=[];w.forEach(I=>{var se;if(!I)return;const T=I.querySelector(".dropdown__link > h4 > a");if(!T)return;const j={key:T.getAttribute("href")||"#",label:((se=T.textContent)==null?void 0:se.trim())||"",children:[]};I.querySelectorAll(".dropdown__submenu.dropdown-aris > li > a").forEach(D=>{var re;D&&j.children.push({key:D.getAttribute("href")||"#",label:((re=D.textContent)==null?void 0:re.trim())||""})}),j.children.length>0?f.push(j):f.push({label:j.label,key:j.key})}),f.length>0&&(y.children=f),s.push(y)}),s}catch(r){return console.error("Error parsing menu:",r),[]}};function je(t){return t.match(/(\b\S)?/g).join("").match(/(^\S|\S$)?/g).join("").toUpperCase()}return i.useEffect(()=>{xe&&x(we({type:"public"}))},[]),i.useEffect(()=>{const t=c=>{const s=c.target.closest("a");if(s&&s.href){const u=new URL(s.href),d=u.pathname+u.search+u.hash;u.origin===window.location.origin&&(c.preventDefault(),M(d))}},r=document.getElementById("root");return r&&r.addEventListener("click",t),()=>{r&&r.removeEventListener("click",t)}},[M]),i.useEffect(()=>{pe&&g.length>0&&x(_e({ids:g}))},[]),i.useEffect(()=>{F==="idle"&&x(Me())},[x,F]),i.useEffect(()=>{var t;if((t=n==null?void 0:n.menuItems)!=null&&t.header){const r=document.getElementById("menu-mobile"),c=()=>S(!0);return r&&r.addEventListener("click",c),()=>{r&&r.removeEventListener("click",c)}}},[n]),i.useEffect(()=>{const t=document.getElementById("icon-user");if(l!=null&&l.userType&&t){E.current||(E.current=A(t));const r=E.current,c=()=>l!=null&&l.avatar?e.jsx(R,{src:l==null?void 0:l.avatar,size:40}):e.jsx(R,{style:{backgroundColor:v},size:40,children:je(l==null?void 0:l.name)});r.render(e.jsx(e.Fragment,{children:c()}))}},[l,v,n]),i.useEffect(()=>{var c;const t=document.getElementById("icon-notify"),r=(c=a==null?void 0:a.newData)==null?void 0:c.map(s=>{const u=k.includes(s==null?void 0:s._id);return{key:s==null?void 0:s._id,label:e.jsxs(Ee,{onClick:()=>{if(he(s),C(!0),!u){const d=[...k,s==null?void 0:s._id];localStorage.setItem("notify",JSON.stringify(d)),me(d)}},gutter:[24,24],style:{width:350},children:[e.jsx(oe,{span:2,children:e.jsx(R,{style:{backgroundColor:v},children:"AD"})}),e.jsxs(oe,{className:"flex justify-between items-center",span:22,children:[e.jsx(Le.Text,{className:"text-inline-notify ms-2",children:(s==null?void 0:s.title)||"No message"}),!u&&e.jsx(H,{color:v})]})]})}});if(t){const s=t.parentNode;L.current||(L.current=A(s));const u=L.current,d=()=>{var y,w;const p=((y=a==null?void 0:a.newData)==null?void 0:y.filter(f=>!k.includes(f==null?void 0:f._id)).length)||0;return((w=a==null?void 0:a.newData)==null?void 0:w.length)>0?e.jsx(Re,{trigger:["click"],menu:{items:r},children:e.jsx(H,{className:"size-full",count:p,children:e.jsx("div",{dangerouslySetInnerHTML:{__html:t.outerHTML}})})}):e.jsx("div",{dangerouslySetInnerHTML:{__html:t.outerHTML}})};u.render(e.jsx(e.Fragment,{children:d()}))}},[a,k]),i.useEffect(()=>{const t=document.getElementById("icon-cart");if(t){const r=t.parentNode;b.current||(b.current=A(r));const c=b.current,s=()=>(g==null?void 0:g.length)>0?e.jsx(H,{className:"size-full",count:N==null?void 0:N.length,children:e.jsx("div",{dangerouslySetInnerHTML:{__html:t.outerHTML}})}):e.jsx("div",{dangerouslySetInnerHTML:{__html:t.outerHTML}});c.render(e.jsx(e.Fragment,{children:s()}))}},[g,N,n]),i.useEffect(()=>{ge&&x(Se())},[]),e.jsxs(be,{children:[e.jsxs(Ce,{children:[e.jsx("meta",{name:"description",content:ce||((O=o[0])==null?void 0:O.description)}),e.jsx("meta",{name:"keywords",content:le||((z=o[0])==null?void 0:z.keywords)}),e.jsx("meta",{name:"author",content:ae||((B=o[0])==null?void 0:B.manage)}),e.jsx("title",{children:ie||((q=o[0])==null?void 0:q.name)}),typeof _=="object"&&Object.keys(_).length>0&&e.jsx("script",{type:"application/ld+json",children:JSON.stringify(_)})]}),((P=n==null?void 0:n.menuItems)==null?void 0:P.css)&&e.jsx(e.Fragment,{children:e.jsx("style",{dangerouslySetInnerHTML:{__html:(J=n==null?void 0:n.menuItems)==null?void 0:J.css}})}),((U=n==null?void 0:n.menuItems)==null?void 0:U.header)&&e.jsx(e.Fragment,{children:e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:500},children:e.jsx("div",{dangerouslySetInnerHTML:{__html:($=n==null?void 0:n.menuItems)==null?void 0:$.header}})})}),e.jsxs("div",{className:"flex flex-col justify-between items-stretch",style:{minHeight:"100dvh"},children:[e.jsx("div",{children:ue}),e.jsx("div",{dangerouslySetInnerHTML:{__html:(K=n==null?void 0:n.menuItems)==null?void 0:K.footer}})]}),e.jsx(Ie,{title:(Q=(G=o==null?void 0:o.newData)==null?void 0:G[0])==null?void 0:Q.name,placement:"left",onClose:()=>S(!1),open:de,width:256,children:e.jsxs("div",{className:"flex flex-col justify-between",style:{height:"100%"},children:[e.jsx(Te,{mode:"inline",onClick:t=>{S(!1),setTimeout(()=>{M(t.key)},500)},style:{width:256},items:ye((V=n==null?void 0:n.menuItems)==null?void 0:V.header)}),e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 my-2",children:[e.jsx(De,{size:22}),(X=(W=o==null?void 0:o.newData)==null?void 0:W[0])==null?void 0:X.email]}),e.jsxs("div",{className:"flex items-center gap-2 my-2",children:[e.jsx(Ae,{size:22}),(Z=(Y=o==null?void 0:o.newData)==null?void 0:Y[0])==null?void 0:Z.phone]}),e.jsxs("div",{className:"flex items-center gap-2 my-2",children:[e.jsx(He,{size:22}),(te=(ee=o==null?void 0:o.newData)==null?void 0:ee[0])==null?void 0:te.address]})]})]})}),e.jsx(Fe,{title:`Thông báo: ${m==null?void 0:m.title}`,centered:!0,open:fe,onOk:()=>C(!1),onCancel:()=>C(!1),width:1e3,children:m==null?void 0:m.content})]})};export{Pe as L};
